<!DOCTYPE html>
<html>
  <head>
    <base href="/">
    <title>Ultra rubik's Cube Solver</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <link rel="stylesheet" href="styles.css">

    <!-- Polyfill(s) for older browsers -->
    <script src="node_modules/core-js/client/shim.min.js"></script>

    <script src="node_modules/zone.js/dist/zone.js"></script>
    <script src="node_modules/reflect-metadata/Reflect.js"></script>
    <script src="node_modules/systemjs/dist/system.src.js"></script>

    <script src="node_modules/tracking/build/tracking.js"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link href="node_modules/@angular/material/prebuilt-themes/indigo-pink.css" rel="stylesheet">
    <script src="node_modules/hammerjs/hammer.min.js"></script>

    <script src="systemjs.config.js"></script>
    <script>
      System.import('app').catch(function(err){ console.error(err); });
    </script>
  </head>

  <body>
    <my-app>
      <div class="loader">
        <span>{</span><span>}</span>
      </div>
    </my-app>
    <script src="node_modules/jquery/dist/jquery.min.js"></script>
    <script src="node_modules/tether/dist/js/tether.min.js"></script>
    <script src="lib/flat.js"></script>
    <script src="lib/rubiks.js"></script>

    <script type="text/javascript">
var cube, cube2;
var flatCube, controls;
/**********************************
 * Main Loop
 **********************************/
var run = function () { 
  cube.tick();
  cube.render();
  if(cube2){
    cube2.tick();
    cube2.render();
  }
  // ---- animation loop ---- 
  requestAnimationFrame(run);
} 
var oldWidth = null
;
var reset = function () { 
  var down = false;
  var parent = document.getElementById('cube').parentElement;
  var width = Math.min(parent.offsetWidth/2-30, parent.offsetHeight/5*3);
  if(width < 250){
    width = window.innerWidth/2-30;
  }
  if(width < 250){
    width = window.innerWidth - 30;
    down = true;
  }
  oldWidth = width;
  cube = new RubiksCube('cube', width);
  flatCube = new FlatCube('flat-cube', width, down);
  controls = new RubiksCubeControls('controls', cube, width);
  cube.flatCube = flatCube;
  flatCube.cube = cube;
}; 
var init = function () { 
  reset(); 
  run(); 
} 
  
window.addEventListener('load', function () { 
  init(); 
  function loop(){
    if(cube.rotating){
      setTimeout(loop,3000);
      return;
    }
    scramble(20);
    solve();
    loop();
  }
}, false);
window.addEventListener('resize', function(){
  var down = false;
  var parent = document.getElementById('cube').parentElement;
  var width = Math.min(parent.offsetWidth/2-30, parent.offsetHeight/5*3);
  if(width < 250){
    width = window.innerWidth/2-30;
  }
  if(width < 250){
    width = window.innerWidth - 30;
    down = true;
  }
  if(width == oldWidth){
    return;
  }
  oldWidth = width;
  cube.updateSize(width);
  controls.setWidth(width);
  flatCube = new FlatCube('flat-cube', width, down);
  cube.flatCube = flatCube;
  flatCube.cube = cube;
  cube.update();
  flatCube.update();
});
</script>

    <!-- <script src="node_modules/bootstrap/dist/js/bootstrap.min.js"></script> -->
  </body>
</html>
